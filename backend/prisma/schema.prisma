generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Submission {
  id                 String   @id @default(uuid())
  request_id         String   @unique
  gateway_name       String
  gateway_logo_name  String?
  whitelabel_name    String
  responsible_name   String
  responsible_email  String
  responsible_phone  String
  developer_name     String
  developer_email    String
  developer_phone    String
  api_doc_url        String?
  api_doc_file_name  String?
  payment_methods    String
  sandbox_keys       String
  production_account String?
  status             String   @default("Pendente")
  approved_at        DateTime?
  integrando_at      DateTime?
  concluido_at       DateTime?
  rejected_reason    String?
  rejected_details   String?
  rejected_at        DateTime?
  rejected_by        String?
  last_event         String?
  last_event_at      DateTime?
  created_at         DateTime @default(now())
  updated_at         DateTime @updatedAt
  deleted_at         DateTime?

  events             SubmissionEvent[]

  @@map("submissions")
}

model SubmissionEvent {
  id            String   @id @default(uuid())
  submission_id String
  type          String
  message       String
  metadata      Json?
  created_at    DateTime @default(now())
  created_by    String?

  submission    Submission @relation(fields: [submission_id], references: [id], onDelete: Cascade)

  @@index([submission_id, created_at(sort: Desc)])
  @@map("submission_events")
}
